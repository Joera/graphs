<!DOCTYPE html>

<meta charset="UTF-8">

<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="stylesheet" href="/assets/css/main.css">


<script src="/assets/scripts/d3.min.js"></script>
<script src="//d3js.org/d3-geo-projection.v2.min.js"></script>
<script src="//d3js.org/topojson.v2.min.js"></script>
<script src="/assets/scripts/moment.min.js"></script>
<script src="/assets/scripts/main.js"></script>


<style>

    body {
        margin: 0;
    }

    iframe {
        border: none;
    }


</style>


<body id="inspiratiebord">


<main>

    <aside>
        <ul id="muni-select">
            <li data-value="all" class="active"><span>Alle gemeenten</span></li>
            <li data-value="aa-en-hunze"><span>Aa en Hunze</span></li>
            <li data-value="appingedam"><span>Appingedam</span></li>
            <li data-value="assen"><span>Assen</span></li>
            <li data-value="delfzijl"><span>Delfzijl</span></li>
            <li data-value="emmen"><span>Emmen</span></li>
            <li data-value="groningen"><span>Groningen</span></li>
            <li data-value="het-hogeland"><span>Het Hogeland</span></li>
            <li data-value="loppersum"><span>Loppersum</span></li>
            <li data-value="midden-groningen"><span>Midden-Groningen</span></li>
            <li data-value="noordenveld"><span>Noordenveld</span></li>
            <li data-value="oldambt"><span>Oldambt</span></li>
            <li data-value="pekela"><span>Pekela</span></li>
            <li data-value="stadskanaal"><span>Stadskanaal</span></li>
            <li data-value="tynaarlo"><span>Tynaarlo</span></li>
            <li data-value="veendam"><span>Veendam</span></li>
            <li data-value="westerkwartier"><span>Westerkwartier</span></li>
            <li data-value="westerwolde"><span>Westerwolde</span></li>
        </ul>
        <ul id="specials-select">
            <li data-value="all"><span>Alle specials</span></li>
            <li data-value="agro"><span>Agro</span></li>
            <li data-value="erfgoed"><span>Erfgoed</span></li>
            <li data-value="bedrijven"><span>Bedrijven</span></li>
            <li data-value="overig"><span>Overige specials</span></li>
        </ul>
    </aside>

    <section id="menu">
        <ul>
            <li class="active" data-nav="vorige-week"><span>Vorige week</span></li>
            <li data-nav="voortgang"><span>Voortgang</span></li>
            <li data-nav="meldingen"><span>Meldingen</span></li>
            <li data-nav="schade-opnames"><span>Schade-opnames</span></li>
            <li data-nav="schadevergoedingen"><span>Schadevergoedingen</span></li>
            <li data-nav="stuwmeerregeleing"><span>Stuwmeerregeling</span></li>
        </ul>
    </section>

    <section id="vorige-week" class="page">

        <!--<article id="map" class="map">-->
            <!--<div class="container"></div>-->
        <!--</article>-->

        <article id="cijfer-nieuwe-meldingen" class="cijfer" data-script="CijfersLine" data-property="nieuwe_MELDING">
            <h3>Schade-meldingen</h3>
            <div class="container"></div>
            <!-- strava grafiek met eigen loopjes op segment -->
        </article>

        <article id="cijfer-nieuwe-opnames" class="cijfer" data-script="Cijfers" data-property="nieuwe_OPNAMES">
            <h3>Schade-opnames</h3>
            <div class="container"></div>
            <!-- strava grafiek met eigen loopjes op segment -->
        </article>

        <article id="cijfer-nieuwe-besluiten" class="cijfer" data-script="Cijfers" data-property="nieuwe_BESCHIKT">
            <h3>Besluiten</h3>
            <div class="container"></div>
            <!-- strava grafiek met eigen loopjes op segment -->
        </article>

        <article id="cijfer-nieuwe-afgehandeld" class="cijfer" data-script="Cijfers" data-property="nieuwe_AFGEHANDELD_TOTAAL">
            <h3>Afgehandelde schade-meldingen</h3>
            <div class="container"></div>
            <!-- strava grafiek met eigen loopjes op segment -->
        </article>

            <!--<article id="map-nieuwe-meldingen" class="map mini-map" data-script="Map" data-property="nieuwe_MELDING">-->
                <!--&lt;!&ndash;<h3>Schade-meldingen</h3>&ndash;&gt;-->
                <!--<div class="container"></div>-->
            <!--</article>-->

            <!--<article id="map-nieuwe-opnames" class="map mini-map" data-script="Map" data-property="nieuwe_OPNAMES">-->
                <!--&lt;!&ndash;<h3>Schade-opnames</h3>&ndash;&gt;-->
                <!--<div class="container"></div>-->
            <!--</article>-->

            <!--<article id="map-nieuwe-besluiten" class="map mini-map" data-script="Map" data-property="nieuwe_BESCHIKT">-->
                <!--&lt;!&ndash;<h3>Besluiten</h3>&ndash;&gt;-->
                <!--<div class="container"></div>-->
            <!--</article>-->

            <!--<article id="map-nieuwe-afgehandeld" class="map mini-map" data-script="Map" data-property="nieuwe_AFGEHANDELD_TOTAAL">-->
                <!--&lt;!&ndash;<h3>Afgehandelde schademeldingen</h3>&ndash;&gt;-->
                <!--<div class="container"></div>-->
            <!--</article>-->

        <!--<article id="pie-toegekende-bedragen" class="pie mini-pie" data-script="PieChartSum" data-property="">-->
            <!--<h3>Toegekende bedragen</h3>-->
            <!--<div class="container"></div>-->
        <!--</article>-->

    </section>

    <section id="voortgang" class="page">


    </section>

    <section id="meldingen" class="page">

        <!--<article id="bars-schade-meldingen" data-script="BarProgression" data-property="schademeldingen">-->
            <!--<h3>Schade-meldingen</h3>-->
            <!--<div class="container"></div>-->
        <!--</article>-->

        <!--<article id="bars-aos-meldingen" data-script="BarProgression" data-property="aos_meldingen">-->
            <!--<h3>AOS meldingen</h3>-->
            <!--<div class="container"></div>-->
        <!--</article>-->

        <!--<article id="map-schade-meldingen" class="map" data-script="Gemeentes" data-property="schademeldingen">-->
            <!--<div class="container"></div>-->
        <!--</article>-->



    </section>


    <section id="schade-opnames" class="page">

        <!--<article id="taart-opnames">-->
            <!--<h3>Soort opname</h3>-->
            <!--<div class="container"></div>-->
        <!--</article>-->

    </section>



    <section id="schadevergoedingen" class="page">



    </section>

    <!--<section id="bedragen">-->
        <!--<h3>Totaal toegekend bedrag: <span></span></h3>-->
        <!--<div class="container"></div>-->
    <!--</section>-->

    <!--<section id="verdeling">-->
        <!--<h3>Ordegrootte van schadevergoedingen</h3>-->
        <!--<div class="container"></div>-->
    <!--</section>-->




    <!--<section id="status-actueel">-->
        <!--<h3>Schademeldingen en hun status</h3>-->
        <!--<div class="container"></div>-->
    <!--</section>-->

    <!--<section id="besluiten">-->
        <!--<h3>Besluiten en schade-opnames</h3>-->
        <!--<div class="container"></div>-->
    <!--</section>-->

    <!--<section id="voortgang">-->
        <!--<h3>Voortgang afhandeling schademeldingen</h3>-->
        <!--<div class="container"></div>-->
    <!--</section>-->

    <!--<section id="candles">-->
        <!--<h3>Voortgang afhandeling schademeldingen</h3>-->
        <!--<div class="container"></div>-->
    <!--</section>-->

    <!--<section id="candles">-->
        <!--<h3>Voortgang afhandeling schademeldingen</h3>-->
        <!--<div class="container"></div>-->
    <!--</section>-->

    <!--<section id="som">-->
        <!--<h3>Totaal toegekend bedrag</h3>-->
        <!--<div class="container"></div>-->
    <!--</section>-->

    <!--<section id="herkomst">-->
        <!--<h3>Herkomst schademeldingen</h3>-->
        <!--<div class="container"></div>-->
    <!--</section>-->

    <!--<section id="opnames">-->
        <!--<h3>Uitvoering opnames</h3>-->
        <!--<div class="container"></div>-->
    <!--</section>-->



</main>


</body>

<script>

    const config = {

        'cijfer-nieuwe-meldingen' : {

            'api' : '/api/data',
            'dataMapping': [

                {
                    label: 'Schade-meldingen',
                    column: 'nieuwe_MELDING',
                    colour: orange
                },
                {
                    label: 'Schade-meldingen',
                    column: 'gem_MELDING',
                    colour: orange
                }
            ]
        },
        'cijfer-nieuwe-opnames' : {

            'api': '/api/data',
            'dataMapping': [
                {
                    label: 'Schade-opnames',
                    column: 'nieuwe_OPNAMES',
                    colour: green
                },
                {
                    label: 'Schade-opnames',
                    column: 'gem_OPNAMES',
                    colour: green
                }
            ]
        },
        'cijfer-nieuwe-besluiten' : {

            'api': '/api/data',
            'dataMapping': [
                {
                    label: 'Besluiten',
                    column: 'nieuwe_BESCHIKT',
                    colour: blue
                },
                {
                    label: 'Besluiten',
                    column: 'gem_BESCHIKT',
                    colour: blue
                }
            ]
        },

        'cijfer-nieuwe-afgehandeld' : {

            'api': '/api/data',
            'dataMapping': [
                {
                    label: 'Afgehandelde schade-meldingen',
                    column: 'nieuwe_AFGEHANDELD_TOTAAL',
                    colour: darkblue
                },
                {
                    label: 'Afgehandelde schade-meldingen',
                    column: 'gem_AFGEHANDELD_TOTAAL',
                    colour: darkblue
                }
            ]
        },

        'map-nieuwe-meldingen' : {

            'api': '/api/gemeentes',
            'dataMapping': [
                {
                    label: 'Schade-meldingen',
                    column: 'nieuwe_MELDING',
                    colour: orange
                }
            ]
        },
        'map-nieuwe-opnames' : {

            'api': '/api/gemeentes',
            'dataMapping': [
                {
                    label: 'Schade-opnames',
                    column: 'nieuwe_OPNAMES',
                    colour: green
                }
            ]
        },
        'map-nieuwe-besluiten' : {

            'api': '/api/gemeentes',
            'dataMapping': [
                {
                    label: 'Besluiten',
                    column: 'nieuwe_BESCHIKT',
                    colour: blue
                }
            ]
        },

        'map-nieuwe-afgehandeld' : {

            'api': '/api/gemeentes',
            'dataMapping': [
                {
                    label: 'Afgehandelde schade-meldingen',
                    column: 'nieuwe_AFGEHANDELD_TOTAAL',
                    colour: darkblue
                }
            ]
        },

        'bars-schade-meldingen' : {

            'api': '/api/gemeentes',
            'dataMapping': [
                {
                    label: 'Schademeldingen',
                    column: 'schademeldingen',
                    colour: 'orange'
                },
                {
                    label: '',
                    column: 'nieuwe_schademeldingen',
                    colour: 'orange'
                }
            ]
        },
        'map-schade-meldingen' : {

            'api': '/api/gemeentes',
            'dataMapping': [
                {
                    label: 'Schade-meldingen',
                    column: 'schademeldingen',
                    colour: 'orange'
                }
            ]
        },
        'pie-toegekende-bedragen' : {

            'api': '/api/gemeentes',
            'smallMultiple' : false,
            'currencyLabels' : true,
            'datamapping': [
                [
                    {
                        label: 'Mijnbouwschade',
                        column: 'BEDRAG_SCHADEBEDRAG',
                        colour: green
                    },
                    {
                        label: 'Stuwmeerregeling',
                        column: 'BEDRAG_SMR',
                        colour: darkblue
                    },
                    {
                        label: 'Bijkomende kosten',
                        column: 'BEDRAG_BIJKOMENDE_KOSTEN',
                        colour: blue
                    },
                    {
                        label: 'Wettelijke rente',
                        column: 'BEDRAG_WETTELIJKE_RENTE',
                        colour: orange
                    }
                ],
                [
                    {
                        label: 'Totaal',
                        column: 'TOTAAL_VERLEEND',
                        colour: yellow
                    }
                ]
            ]
        },
        'bars-aos-meldingen' : {

            'smallMultiple': false,
            'minValue': 0,
            'xParameter': '_date',
            'yParameter': 'aos_meldingen',
            'xScaleType': 'time',
            'xScaleTicks': 'timeMonth',
            'yScaleType': 'linear',
            'barWidth': 6,
            'circleRadius': 6,
            'tooltipWidth': 100,
            'dataMapping': [
                {
                    label: 'AOS meldingen',
                    column: 'aos_meldingen',
                    colour: 'blue'
                },
                {
                    label: '',
                    column: 'nieuwe_aos_meldingen',
                    colour: 'blue'
                }
            ]
        },
        'map-aos-meldingen' : {

            'api': '/api/gemeentes',
            'dataMapping': [
                {
                    label: 'AOS meldingen',
                    column: 'AOS',
                    colour: '#65A7C5'
                }
            ]
        }
    }

        // let globalData = {};

        // bedragen('#bedragen .container', true);
        // verdeling('#verdeling .container', true);
        //  gemeentes('#map-meldingen .map-container');

        // meldingen('#schademeldingen .container', true);
        // aosMeldingen('#aosmeldingen .container', true);
        // pieChartOpnames('#taart-opnames');


        // statussen('#status-actueel .container', true);
        // opnames('#besluiten .container', true);
        // voortgang('#voortgang .container', true);
        // candles('#candles .container', true);
        // pieChartSum('#som .container',true);
        // pieChartHerkomst('#herkomst .container',true);
        // pieChartOpnames('#opnames .container', true);

    let page = 'vorige-week';
    let segment = 'all';
    let graphs = [];

    let municipalityOptions = [].slice.call(document.querySelectorAll('ul#muni-select li'));
    let specialOptions = [].slice.call(document.querySelectorAll('ul#specials-select li'));
    let segmentOptions = municipalityOptions.concat(specialOptions);
    let menuOptions = [].slice.call(document.querySelectorAll('#menu ul li'));
    let pages = [].slice.call(document.querySelectorAll('section.page'));

    let openPage = function openPage(pageName) {

        for (let page of pages) {

            if (page.id === pageName) {

                page.style.display = 'grid';

                for (let vis of [].slice.call(page.querySelectorAll('article'))) {

                    // clear html in containers
                    vis.querySelector('.container').innerHTML = '';

                    graphs[vis.id] = new window[vis.getAttribute('data-script')](config[vis.id].api,vis.querySelector('.container'), config, config[vis.id].dataMapping, segment, vis.getAttribute('data-property'),true);
                    graphs[vis.id].init();

                    // uniformize props in function --> window[method](el,dataMapping,property,segment,smallMultiple)
             //       window[vis.getAttribute('data-script')](vis.querySelector('.container'),dataMapping[vis.id],vis.getAttribute('data-property'),true);
                }

            } else {

                page.style.display = 'none';
            }
        }
    }

    let changeSegment = function changeSegment(newSegment) {

        segment = newSegment;


        for (let graph of Object.values(graphs)) {
            // what do we do with data?
            graph.redraw('',segment)
        }


    }


    menuOptions.forEach( (o) => {

        o.addEventListener( 'click', () => {

            openPage(o.getAttribute('data-nav'));
        });
    });

    segmentOptions.forEach( (o) => {

        o.addEventListener( 'click', () => {

            changeSegment(o.getAttribute('data-value'));
        });
    });

    d3.json('https://tcmg-hub.publikaan.nl/api/gemeenten', function(error, json) {
        if (error) throw error;
        globalData.geoData = topojson.feature(json, json.objects.gemeenten).features;

        d3.json('https://tcmg-hub.publikaan.nl/api/gemeentes', function (error, json) {
            if (error) throw error;
            globalData.gemeentes = json;
            openPage(page);
        });
    });

</script>

</html>